---
import { getCollection } from 'astro:content';
import BaseLayout from '@layouts/BaseLayout.astro';
import { formatDate } from '@lib/utils';

const posts = await getCollection('blog', ({ data }) => !data.draft);
const sortedPosts = posts.sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime()
);
---

<BaseLayout title="Plastic Surgery Blog">
  <main>
    <h1>Plastic Surgery Blog</h1>
    <ul>
      {
        sortedPosts.map((post) => (
          <li>
            <a href={`/blog/${post.id}`}>
              <h2>{post.data.title}</h2>
              <p>{post.data.description}</p>
              <time datetime={post.data.date.toISOString()}>
                {formatDate(post.data.date)}
              </time>
            </a>
          </li>
        ))
      }
    </ul>
  </main>
</BaseLayout>
